<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="131,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T63U3">sp_set</span>, <span class="var type1" id="S3T86U4">sp_val</span>, <span class="var type1" id="S4T1U5">bspline_set</span>, <span class="var type1" id="S5T63U6">ref_set</span>] = segmentation(<span class="var type1" id="S6T2U9">Sp2</span>, <span class="var type1" id="S7T2U10">Confidence</span>, <span class="var type1" id="S8T57U11">DCF</span>, <span class="var type1" id="S9T57U12">Ref</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="131,2" id="srcline2">  2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,4" id="srcline4">  4</a></span><span class="line">coder.inline(<span class="string">'never'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="131,5" id="srcline5">  5</a></span><span class="line">coder.varsize(<span class="string">'sp_val'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,6" id="srcline6">  6</a></span><span class="line">coder.varsize(<span class="string">'sp_set'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,7" id="srcline7">  7</a></span><span class="line">coder.varsize(<span class="string">'sp_set(:).val'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,8" id="srcline8">  8</a></span><span class="line">coder.varsize(<span class="string">'sp_set2'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,9" id="srcline9">  9</a></span><span class="line">coder.varsize(<span class="string">'sp_set2(:).val'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,10" id="srcline10"> 10</a></span><span class="line">coder.varsize(<span class="string">'bspline_set'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,11" id="srcline11"> 11</a></span><span class="line">coder.varsize(<span class="string">'bspline_set(:).x'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,12" id="srcline12"> 12</a></span><span class="line">coder.varsize(<span class="string">'bspline_set(:).y'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,13" id="srcline13"> 13</a></span><span class="line">coder.varsize(<span class="string">'bspline_set2'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,14" id="srcline14"> 14</a></span><span class="line">coder.varsize(<span class="string">'bspline_set2(:).x'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,15" id="srcline15"> 15</a></span><span class="line">coder.varsize(<span class="string">'bspline_set2(:).y'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,16" id="srcline16"> 16</a></span><span class="line">coder.varsize(<span class="string">'ref_set'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,17" id="srcline17"> 17</a></span><span class="line">coder.varsize(<span class="string">'ref_set(:).val'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,18" id="srcline18"> 18</a></span><span class="line">coder.varsize(<span class="string">'ref_set2'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,19" id="srcline19"> 19</a></span><span class="line">coder.varsize(<span class="string">'ref_set2(:).val'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,20" id="srcline20"> 20</a></span><span class="line">coder.varsize(<span class="string">'point_x'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,21" id="srcline21"> 21</a></span><span class="line">coder.varsize(<span class="string">'point_y'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="131,22" id="srcline22"> 22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,23" id="srcline23"> 23</a></span><span class="line"><span class="mxinfo" id="T5:U9">[<span class="var type1" id="S11T5U124">x</span>, <span class="var type1" id="S12T5U125">y</span>] = size(<span class="var type1" id="S6T2U128">Sp2</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,24" id="srcline24"> 24</a></span><span class="line"><span class="mxinfo" id="T63:U13"><span class="var type1" id="S2T63U131">sp_set</span> = <span class="mxinfo" id="T111:U15">struct(<span class="string">'val'</span>, [])</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,25" id="srcline25"> 25</a></span><span class="line"><span class="mxinfo" id="T86:U16"><span class="var type1" id="S3T86U139">sp_val</span> = <span class="mxinfo" id="T49:U18">[]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,26" id="srcline26"> 26</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">%% get superpixels in coordinate form</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,28" id="srcline28"> 28</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S15T5U144">i</span> = <span class="mxinfo" id="T5:U20">1</span>:<span class="var type1" id="S11T5U147">x</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,29" id="srcline29"> 29</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S16T5U150">j</span> = <span class="mxinfo" id="T5:U23">1</span>:<span class="var type1" id="S12T5U153">y</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,30" id="srcline30"> 30</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T6:U25"><span class="mxinfo" id="T5:U26">sum(<span class="mxinfo" id="T30:U27">find(<span class="mxinfo" id="T112:U28"><span class="var type1" id="S3T86U162">sp_val</span> == <span class="mxinfo" id="T5:U30"><span class="var type1" id="S6T2U164">Sp2</span>(<span class="var type1" id="S15T5U165">i</span>,<span class="var type1" id="S16T5U166">j</span>)</span></span>)</span>)</span> == <span class="mxinfo" id="T5:U34">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="131,31" id="srcline31"> 31</a></span><span class="line">            <span class="mxinfo" id="T30:U35"><span class="var type1" id="S19T30U170">vec</span> = <span class="mxinfo" id="T30:U37">find(<span class="mxinfo" id="T64:U38"><span class="var type1" id="S6T2U174">Sp2</span> == <span class="mxinfo" id="T5:U40"><span class="var type1" id="S6T2U176">Sp2</span>(<span class="var type1" id="S15T5U177">i</span>,<span class="var type1" id="S16T5U178">j</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,32" id="srcline32"> 32</a></span><span class="line">            <span class="mxinfo" id="T86:U44"><span class="var type1" id="S3T86U181">sp_val</span> = <span class="mxinfo" id="T30:U46">[<span class="var type1" id="S3T86U184">sp_val</span>;<span class="mxinfo" id="T5:U48"><span class="var type1" id="S6T2U187">Sp2</span>(<span class="var type1" id="S15T5U188">i</span>,<span class="var type1" id="S16T5U189">j</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,33" id="srcline33"> 33</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="131,34" id="srcline34"> 34</a></span><span class="line">            <span class="mxinfo" id="T4:U52"><span class="var type1" id="S20T4U192">new_set</span> = <span class="mxinfo" id="T4:U54">zeros(<span class="mxinfo" id="T5:U55">size(<span class="var type1" id="S19T30U197">vec</span>,1)</span>, <span class="mxinfo" id="T5:U57">2</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,35" id="srcline35"> 35</a></span><span class="line">            <span class="mxinfo" id="T30:U58"><span class="mxinfo" id="T30:U59"><span class="var type1" id="S20T4U204">new_set</span>(:,1)</span> = <span class="mxinfo" id="T30:U61">mod(<span class="var type1" id="S19T30U209">vec</span>, <span class="var type1" id="S11T5U210">x</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,36" id="srcline36"> 36</a></span><span class="line">            <span class="mxinfo" id="T30:U64"><span class="mxinfo" id="T30:U65"><span class="var type1" id="S20T4U214">new_set</span>(:,2)</span> = <span class="mxinfo" id="T30:U67">ceil(<span class="mxinfo" id="T30:U68"><span class="var type1" id="S19T30U220">vec</span>/<span class="var type1" id="S11T5U221">x</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,37" id="srcline37"> 37</a></span><span class="line">            <span class="mxinfo" id="T30:U71"><span class="mxinfo" id="T30:U72"><span class="var type1" id="S20T4U225">new_set</span>(<span class="mxinfo" id="T71:U74"><span class="var type1" id="S20T4U227">new_set</span>==<span class="mxinfo" id="T5:U76">0</span></span>)</span>=<span class="var type1" id="S11T5U229">x</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,38" id="srcline38"> 38</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="131,39" id="srcline39"> 39</a></span><span class="line">            <span class="mxinfo" id="T4:U78"><span class="mxinfo" id="T4:U79"><span class="var type1" id="S24T74U233">item</span>.val</span> = <span class="var type1" id="S20T4U235">new_set</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,40" id="srcline40"> 40</a></span><span class="line">            <span class="mxinfo" id="T63:U82"><span class="var type1" id="S2T63U238">sp_set</span> = <span class="mxinfo" id="T63:U84">[<span class="var type1" id="S2T63U241">sp_set</span>, <span class="var type1" id="S24T74U242">item</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,41" id="srcline41"> 41</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="131,42" id="srcline42"> 42</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,43" id="srcline43"> 43</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,44" id="srcline44"> 44</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,45" id="srcline45"> 45</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,46" id="srcline46"> 46</a></span><span class="line"><span class="mxinfo" id="T63:U87"><span class="var type1" id="S2T63U246">sp_set</span>(1) = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,47" id="srcline47"> 47</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,48" id="srcline48"> 48</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,49" id="srcline49"> 49</a></span><span class="line"><span class="comment">%% remove point with low confidence</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,50" id="srcline50"> 50</a></span><span class="line"><span class="mxinfo" id="T5:U89"><span class="var type1" id="S25T5U252">surface_amount</span> = <span class="mxinfo" id="T5:U91">size(<span class="var type1" id="S2T63U255">sp_set</span>, 2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,51" id="srcline51"> 51</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S15T5U259">i</span> = <span class="mxinfo" id="T5:U94">1</span>:<span class="var type1" id="S25T5U262">surface_amount</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,52" id="srcline52"> 52</a></span><span class="line">    <span class="mxinfo" id="T5:U96"><span class="var type1" id="S26T5U265">point_amount</span> = size(<span class="mxinfo" id="T2:U98"><span class="mxinfo" id="T109:U99"><span class="var type1" id="S2T63U270">sp_set</span>(<span class="var type1" id="S15T5U271">i</span>)</span>.val</span>, 1)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,53" id="srcline53"> 53</a></span><span class="line">    <span class="mxinfo" id="T30:U102"><span class="var type1" id="S27T30U276">point_x</span> = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,54" id="srcline54"> 54</a></span><span class="line">    <span class="mxinfo" id="T30:U104"><span class="var type1" id="S28T30U281">point_y</span> = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,55" id="srcline55"> 55</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S16T5U286">j</span> = <span class="mxinfo" id="T5:U107">1</span>:<span class="var type1" id="S26T5U289">point_amount</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,56" id="srcline56"> 56</a></span><span class="line">        <span class="mxinfo" id="T25:U109"><span class="var type1" id="S29T25U292">point</span> = <span class="mxinfo" id="T25:U111">[<span class="mxinfo" id="T5:U112"><span class="mxinfo" id="T2:U113"><span class="mxinfo" id="T109:U114"><span class="var type1" id="S2T63U298">sp_set</span>(<span class="var type1" id="S15T5U299">i</span>)</span>.val</span>(<span class="var type1" id="S16T5U301">j</span>,<span class="mxinfo" id="T5:U118">1</span>)</span>, <span class="mxinfo" id="T5:U119"><span class="mxinfo" id="T2:U120"><span class="mxinfo" id="T109:U121"><span class="var type1" id="S2T63U306">sp_set</span>(<span class="var type1" id="S15T5U307">i</span>)</span>.val</span>(<span class="var type1" id="S16T5U309">j</span>,<span class="mxinfo" id="T5:U125">2</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,57" id="srcline57"> 57</a></span><span class="line">        <span class="mxinfo" id="T75:U126"><span class="var type1" id="S30T75U313">ref_pos</span> = <span class="mxinfo" id="T75:U128"><span class="var type1" id="S8T57U315">DCF</span>(<span class="mxinfo" id="T5:U130"><span class="var type1" id="S29T25U317">point</span>(<span class="mxinfo" id="T5:U132">1</span>)</span>, <span class="mxinfo" id="T5:U133"><span class="var type1" id="S29T25U320">point</span>(<span class="mxinfo" id="T5:U135">2</span>)</span>, : )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,58" id="srcline58"> 58</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo" id="T6:U136"><span class="mxinfo" id="T5:U137"><span class="var type1" id="S30T75U331">ref_pos</span>(<span class="mxinfo" id="T5:U139">1</span>)</span> &gt; <span class="mxinfo" id="T5:U140">0</span></span>) &amp;&amp; (<span class="mxinfo" id="T6:U141"><span class="mxinfo" id="T5:U142"><span class="var type1" id="S30T75U337">ref_pos</span>(<span class="mxinfo" id="T5:U144">1</span>)</span> &lt;= <span class="var type1" id="S12T5U339">y</span></span>) &amp;&amp; (<span class="mxinfo" id="T6:U146"><span class="mxinfo" id="T5:U147"><span class="var type1" id="S30T75U343">ref_pos</span>(<span class="mxinfo" id="T5:U149">2</span>)</span> &gt; <span class="mxinfo" id="T5:U150">0</span></span>) &amp;&amp; (<span class="mxinfo" id="T6:U151"><span class="mxinfo" id="T5:U152"><span class="var type1" id="S30T75U349">ref_pos</span>(<span class="mxinfo" id="T5:U154">2</span>)</span> &lt;= <span class="var type1" id="S11T5U351">x</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="131,59" id="srcline59"> 59</a></span><span class="line">            <span class="mxinfo" id="T30:U156"><span class="var type1" id="S27T30U354">point_x</span> = <span class="mxinfo" id="T30:U158">[<span class="var type1" id="S27T30U357">point_x</span>; <span class="mxinfo" id="T5:U160"><span class="var type1" id="S29T25U360">point</span>(<span class="mxinfo" id="T5:U162">1</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,60" id="srcline60"> 60</a></span><span class="line">            <span class="mxinfo" id="T30:U163"><span class="var type1" id="S28T30U364">point_y</span> = <span class="mxinfo" id="T30:U165">[<span class="var type1" id="S28T30U367">point_y</span>; <span class="mxinfo" id="T5:U167"><span class="var type1" id="S29T25U370">point</span>(<span class="mxinfo" id="T5:U169">2</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,61" id="srcline61"> 61</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,62" id="srcline62"> 62</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,63" id="srcline63"> 63</a></span><span class="line">    <span class="mxinfo" id="T2:U170"><span class="mxinfo" id="T2:U171"><span class="mxinfo" id="T109:U172"><span class="var type1" id="S2T63U376">sp_set</span>(<span class="var type1" id="S15T5U377">i</span>)</span>.val</span> = <span class="mxinfo" id="T4:U175">[<span class="var type1" id="S27T30U381">point_x</span>, <span class="var type1" id="S28T30U382">point_y</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,64" id="srcline64"> 64</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,65" id="srcline65"> 65</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,66" id="srcline66"> 66</a></span><span class="line"><span class="comment">%% remove surface with low confidence</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,67" id="srcline67"> 67</a></span><span class="line"><span class="mxinfo" id="T5:U178"><span class="var type1" id="S25T5U385">surface_amount</span> = <span class="mxinfo" id="T5:U180">size(<span class="var type1" id="S2T63U388">sp_set</span>, 2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,68" id="srcline68"> 68</a></span><span class="line"><span class="mxinfo" id="T63:U182"><span class="var type1" id="S31T63U392">sp_set2</span> = <span class="mxinfo" id="T111:U184">struct(<span class="string">'val'</span>, [])</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,69" id="srcline69"> 69</a></span><span class="line"><span class="mxinfo" id="T30:U185"><span class="var type1" id="S32T30U400">sp_val2</span> = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,70" id="srcline70"> 70</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,71" id="srcline71"> 71</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S15T5U405">i</span> = <span class="mxinfo" id="T5:U188">1</span>:<span class="var type1" id="S25T5U408">surface_amount</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,72" id="srcline72"> 72</a></span><span class="line">    <span class="mxinfo" id="T5:U190"><span class="var type1" id="S26T5U411">point_amount</span> = size(<span class="mxinfo" id="T2:U192"><span class="mxinfo" id="T109:U193"><span class="var type1" id="S2T63U416">sp_set</span>(<span class="var type1" id="S15T5U417">i</span>)</span>.val</span>, 1)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,73" id="srcline73"> 73</a></span><span class="line">    <span class="mxinfo" id="T5:U196"><span class="var type1" id="S33T5U422">con</span> = <span class="mxinfo" id="T5:U198">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,74" id="srcline74"> 74</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S16T5U426">j</span> = <span class="mxinfo" id="T5:U200">1</span>:<span class="var type1" id="S26T5U429">point_amount</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,75" id="srcline75"> 75</a></span><span class="line">        <span class="mxinfo" id="T5:U202"><span class="var type1" id="S33T5U432">con</span> = <span class="mxinfo" id="T5:U204"><span class="var type1" id="S33T5U434">con</span> + <span class="mxinfo" id="T5:U206"><span class="var type1" id="S7T2U436">Confidence</span>(<span class="mxinfo" id="T5:U208"><span class="mxinfo" id="T2:U209"><span class="mxinfo" id="T109:U210"><span class="var type1" id="S2T63U440">sp_set</span>(<span class="var type1" id="S15T5U441">i</span>)</span>.val</span>(<span class="var type1" id="S16T5U443">j</span>,<span class="mxinfo" id="T5:U214">1</span>)</span>, <span class="mxinfo" id="T5:U215"><span class="mxinfo" id="T2:U216"><span class="mxinfo" id="T109:U217"><span class="var type1" id="S2T63U448">sp_set</span>(<span class="var type1" id="S15T5U449">i</span>)</span>.val</span>(<span class="var type1" id="S16T5U451">j</span>,<span class="mxinfo" id="T5:U221">2</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,76" id="srcline76"> 76</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,77" id="srcline77"> 77</a></span><span class="line">    <span class="mxinfo" id="T5:U222"><span class="var type1" id="S33T5U455">con</span> = <span class="mxinfo" id="T5:U224"><span class="var type1" id="S33T5U457">con</span>/<span class="var type1" id="S26T5U458">point_amount</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,78" id="srcline78"> 78</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T6:U227"><span class="var type1" id="S33T5U462">con</span> &gt;= <span class="mxinfo" id="T5:U229">0.8</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="131,79" id="srcline79"> 79</a></span><span class="line">        <span class="mxinfo" id="T63:U230"><span class="var type1" id="S31T63U466">sp_set2</span> = <span class="mxinfo" id="T63:U232">[<span class="var type1" id="S31T63U469">sp_set2</span>, <span class="mxinfo" id="T109:U234"><span class="var type1" id="S2T63U471">sp_set</span>(<span class="var type1" id="S15T5U472">i</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,80" id="srcline80"> 80</a></span><span class="line">        <span class="mxinfo" id="T30:U237"><span class="var type1" id="S32T30U475">sp_val2</span> = <span class="mxinfo" id="T30:U239">[<span class="var type1" id="S32T30U478">sp_val2</span>; <span class="mxinfo" id="T5:U241"><span class="var type1" id="S3T86U481">sp_val</span>(<span class="var type1" id="S15T5U482">i</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,81" id="srcline81"> 81</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,82" id="srcline82"> 82</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,83" id="srcline83"> 83</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,84" id="srcline84"> 84</a></span><span class="line"><span class="mxinfo" id="T63:U244"><span class="var type1" id="S31T63U486">sp_set2</span>(1) = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,85" id="srcline85"> 85</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,86" id="srcline86"> 86</a></span><span class="line"><span class="mxinfo" id="T63:U246"><span class="var type1" id="S2T63U492">sp_set</span> = <span class="var type1" id="S31T63U493">sp_set2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,87" id="srcline87"> 87</a></span><span class="line"><span class="mxinfo" id="T86:U249"><span class="var type1" id="S3T86U496">sp_val</span> = <span class="var type1" id="S32T30U497">sp_val2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,88" id="srcline88"> 88</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,89" id="srcline89"> 89</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,90" id="srcline90"> 90</a></span><span class="line"><span class="comment">%% compute bsplines of superpixels</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,91" id="srcline91"> 91</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,92" id="srcline92"> 92</a></span><span class="line"><span class="mxinfo" id="T5:U252"><span class="var type1" id="S25T5U500">surface_amount</span> = <span class="mxinfo" id="T5:U254">size(<span class="var type1" id="S2T63U503">sp_set</span>, 2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,93" id="srcline93"> 93</a></span><span class="line"><span class="mxinfo" id="T1:U256"><span class="var type1" id="S4T1U507">bspline_set</span> = <span class="mxinfo" id="T113:U258">struct(<span class="string">'x'</span>, [], <span class="string">'y'</span>, [])</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,94" id="srcline94"> 94</a></span><span class="line"><span class="mxinfo" id="T30:U259"><span class="var type1" id="S34T30U518">error_set</span> = <span class="mxinfo" id="T30:U261">zeros(<span class="var type1" id="S25T5U521">surface_amount</span>, 1, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,95" id="srcline95"> 95</a></span><span class="line"><span class="mxinfo" id="T63:U263"><span class="var type1" id="S5T63U526">ref_set</span> = <span class="mxinfo" id="T111:U265">struct(<span class="string">'val'</span>, [])</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,96" id="srcline96"> 96</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,97" id="srcline97"> 97</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S15T5U534">i</span> = <span class="mxinfo" id="T5:U267">1</span>:<span class="var type1" id="S25T5U537">surface_amount</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,98" id="srcline98"> 98</a></span><span class="line">   <span class="mxinfo" id="T4:U269"><span class="var type1" id="S35T4U540">ref_point</span> = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,99" id="srcline99"> 99</a></span><span class="line">   <span class="mxinfo" id="T5:U271"><span class="var type1" id="S26T5U545">point_amount</span> = size(<span class="mxinfo" id="T2:U273"><span class="mxinfo" id="T109:U274"><span class="var type1" id="S2T63U550">sp_set</span>(<span class="var type1" id="S15T5U551">i</span>)</span>.val</span>, 1)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,100" id="srcline100">100</a></span><span class="line">   <span class="keyword">for</span> <span class="var type1" id="S16T5U556">j</span> = <span class="mxinfo" id="T5:U278">1</span>:<span class="var type1" id="S26T5U559">point_amount</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,101" id="srcline101">101</a></span><span class="line">       <span class="mxinfo" id="T75:U280"><span class="var type1" id="S30T75U562">ref_pos</span> = <span class="mxinfo" id="T75:U282"><span class="var type1" id="S8T57U564">DCF</span>(<span class="mxinfo" id="T5:U284"><span class="mxinfo" id="T2:U285"><span class="mxinfo" id="T109:U286"><span class="var type1" id="S2T63U568">sp_set</span>(<span class="var type1" id="S15T5U569">i</span>)</span>.val</span>(<span class="var type1" id="S16T5U571">j</span>,<span class="mxinfo" id="T5:U290">1</span>)</span>, <span class="mxinfo" id="T5:U291"><span class="mxinfo" id="T2:U292"><span class="mxinfo" id="T109:U293"><span class="var type1" id="S2T63U576">sp_set</span>(<span class="var type1" id="S15T5U577">i</span>)</span>.val</span>(<span class="var type1" id="S16T5U579">j</span>,<span class="mxinfo" id="T5:U297">2</span>)</span>, : )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,102" id="srcline102">102</a></span><span class="line">       <span class="mxinfo" id="T4:U298"><span class="var type1" id="S35T4U584">ref_point</span> = <span class="mxinfo" id="T4:U300">[<span class="var type1" id="S35T4U587">ref_point</span>;<span class="mxinfo" id="T25:U302">[<span class="mxinfo" id="T5:U303"><span class="var type1" id="S30T75U592">ref_pos</span>(<span class="mxinfo" id="T5:U305">2</span>)</span>, <span class="mxinfo" id="T5:U306"><span class="var type1" id="S30T75U595">ref_pos</span>(<span class="mxinfo" id="T5:U308">1</span>)</span>]</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,103" id="srcline103">103</a></span><span class="line">   <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,104" id="srcline104">104</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="131,105" id="srcline105">105</a></span><span class="line">   <span class="mxinfo" id="T30:U309"><span class="mxinfo" id="T30:U310"><span class="var type1" id="S35T4U600">ref_point</span>(<span class="mxinfo" id="T71:U312"><span class="var type1" id="S35T4U602">ref_point</span>&lt;<span class="mxinfo" id="T5:U314">1</span></span>)</span>=<span class="mxinfo" id="T5:U315">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,106" id="srcline106">106</a></span><span class="line">   <span class="mxinfo" id="T30:U316"><span class="mxinfo" id="T30:U317"><span class="var type1" id="S35T4U608">ref_point</span>(<span class="mxinfo" id="T48:U319"><span class="mxinfo" id="T30:U320"><span class="var type1" id="S35T4U611">ref_point</span>(:, <span class="mxinfo" id="T5:U322">1</span>)</span>&gt;<span class="var type1" id="S11T5U614">x</span></span>, 1)</span>=<span class="var type1" id="S11T5U616">x</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,107" id="srcline107">107</a></span><span class="line">   <span class="mxinfo" id="T30:U325"><span class="mxinfo" id="T30:U326"><span class="var type1" id="S35T4U620">ref_point</span>(<span class="mxinfo" id="T48:U328"><span class="mxinfo" id="T30:U329"><span class="var type1" id="S35T4U623">ref_point</span>(:, <span class="mxinfo" id="T5:U331">2</span>)</span>&gt;<span class="var type1" id="S12T5U626">y</span></span>, 2)</span>=<span class="var type1" id="S12T5U628">y</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,108" id="srcline108">108</a></span><span class="line">   <span class="mxinfo" id="T74:U334"><span class="var type1" id="S24T74U631">item</span> = <span class="mxinfo" id="T74:U336">struct(<span class="string">'val'</span>, <span class="var type1" id="S35T4U635">ref_point</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,109" id="srcline109">109</a></span><span class="line">   <span class="mxinfo" id="T63:U338"><span class="var type1" id="S5T63U638">ref_set</span> = <span class="mxinfo" id="T63:U340">[<span class="var type1" id="S5T63U641">ref_set</span>, <span class="var type1" id="S24T74U642">item</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,110" id="srcline110">110</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="131,111" id="srcline111">111</a></span><span class="line">   <span class="mxinfo" id="T62:U343">[<span class="var type1" id="S36T62U646">control_p</span>, <span class="var type1" id="S37T5U647">error</span>] = <span class="fcn" id="F727N3:B649">bspline_inv</span>(<span class="mxinfo" id="T2:U346"><span class="mxinfo" id="T109:U347"><span class="var type1" id="S2T63U652">sp_set</span>(<span class="var type1" id="S15T5U653">i</span>)</span>.val</span>, <span class="var type1" id="S35T4U655">ref_point</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,112" id="srcline112">112</a></span><span class="line">   <span class="mxinfo" id="T28:U351"><span class="var type1" id="S24T28U658">item</span> = <span class="mxinfo" id="T28:U353">struct(<span class="string">'x'</span>, <span class="mxinfo" id="T2:U354"><span class="var type1" id="S36T62U663">control_p</span>(:,:,<span class="mxinfo" id="T5:U356">1</span>)</span>, <span class="string">'y'</span>, <span class="mxinfo" id="T2:U357"><span class="var type1" id="S36T62U669">control_p</span>(:,:,<span class="mxinfo" id="T5:U359">2</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,113" id="srcline113">113</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="131,114" id="srcline114">114</a></span><span class="line">   <span class="mxinfo" id="T87:U360"><span class="var type1" id="S39T87U675">bound</span> = <span class="mxinfo" id="T87:U362">min(<span class="mxinfo" id="T2:U363"><span class="mxinfo" id="T109:U364"><span class="var type1" id="S2T63U680">sp_set</span>(<span class="var type1" id="S15T5U681">i</span>)</span>.val</span>, [], 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,115" id="srcline115">115</a></span><span class="line">   <span class="mxinfo" id="T70:U367"><span class="var type1" id="S41T70U688">ref_p</span> = <span class="mxinfo" id="T70:U369">int32(<span class="mxinfo" id="T4:U370"><span class="fcn" id="F736N2:B692">bspline</span>(<span class="mxinfo" id="T2:U371"><span class="mxinfo" id="T109:U372"><span class="var type1" id="S2T63U695">sp_set</span>(<span class="var type1" id="S15T5U696">i</span>)</span>.val</span>, <span class="var type1" id="S24T28U698">item</span>, <span class="var type1" id="S39T87U699">bound</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,116" id="srcline116">116</a></span><span class="line">   <span class="mxinfo" id="T110:U377"><span class="mxinfo" id="T110:U378"><span class="var type1" id="S41T70U703">ref_p</span>(<span class="mxinfo" id="T71:U380"><span class="var type1" id="S41T70U705">ref_p</span>&lt;<span class="mxinfo" id="T5:U382">1</span></span>)</span>=<span class="mxinfo" id="T5:U383">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,117" id="srcline117">117</a></span><span class="line">   <span class="mxinfo" id="T110:U384"><span class="mxinfo" id="T110:U385"><span class="var type1" id="S41T70U711">ref_p</span>(<span class="mxinfo" id="T48:U387"><span class="mxinfo" id="T110:U388"><span class="var type1" id="S41T70U714">ref_p</span>(:, <span class="mxinfo" id="T5:U390">1</span>)</span>&gt;<span class="var type1" id="S11T5U717">x</span></span>, 1)</span>=<span class="var type1" id="S11T5U719">x</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,118" id="srcline118">118</a></span><span class="line">   <span class="mxinfo" id="T110:U393"><span class="mxinfo" id="T110:U394"><span class="var type1" id="S41T70U723">ref_p</span>(<span class="mxinfo" id="T48:U396"><span class="mxinfo" id="T110:U397"><span class="var type1" id="S41T70U726">ref_p</span>(:, <span class="mxinfo" id="T5:U399">2</span>)</span>&gt;<span class="var type1" id="S12T5U729">y</span></span>, 2)</span>=<span class="var type1" id="S12T5U731">y</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,119" id="srcline119">119</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="131,120" id="srcline120">120</a></span><span class="line">   <span class="mxinfo" id="T72:U402"><span class="var type1" id="S44T72U734">val_p</span> = <span class="mxinfo" id="T72:U404"><span class="fcn" id="F676N8:B736">getPixelsValue</span>(<span class="var type1" id="S9T57U737">Ref</span>, <span class="var type1" id="S41T70U738">ref_p</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,121" id="srcline121">121</a></span><span class="line">   <span class="mxinfo" id="T72:U407"><span class="var type1" id="S46T72U741">val_o</span> = <span class="mxinfo" id="T72:U409"><span class="fcn" id="F737N8:B743">getPixelsValue</span>(<span class="var type1" id="S9T57U744">Ref</span>, <span class="var type1" id="S35T4U745">ref_point</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,122" id="srcline122">122</a></span><span class="line">   <span class="mxinfo" id="T5:U412"><span class="mxinfo" id="T5:U413"><span class="var type1" id="S34T30U749">error_set</span>(<span class="var type1" id="S15T5U750">i</span>)</span> = <span class="mxinfo" id="T5:U416"><span class="mxinfo" id="T5:U417">sum(<span class="mxinfo" id="T60:U418">sum(<span class="mxinfo" id="T72:U419">(<span class="mxinfo" id="T72:U420"><span class="var type1" id="S44T72U759">val_p</span> - <span class="var type1" id="S46T72U760">val_o</span></span>).^2</span>)</span>)</span> / <span class="var type1" id="S26T5U762">point_amount</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,123" id="srcline123">123</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="131,124" id="srcline124">124</a></span><span class="line">   <span class="mxinfo" id="T1:U424"><span class="var type1" id="S4T1U765">bspline_set</span> = <span class="mxinfo" id="T1:U426">[<span class="var type1" id="S4T1U768">bspline_set</span>, <span class="var type1" id="S24T28U769">item</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,125" id="srcline125">125</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="131,126" id="srcline126">126</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,127" id="srcline127">127</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,128" id="srcline128">128</a></span><span class="line"><span class="mxinfo" id="T1:U429"><span class="var type1" id="S4T1U773">bspline_set</span>(1) = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,129" id="srcline129">129</a></span><span class="line"><span class="mxinfo" id="T63:U431"><span class="var type1" id="S5T63U780">ref_set</span>(1) = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,130" id="srcline130">130</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,131" id="srcline131">131</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,132" id="srcline132">132</a></span><span class="line"><span class="comment">%% remove surfaces with too big error</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,133" id="srcline133">133</a></span><span class="line"><span class="mxinfo" id="T30:U433"><span class="var type1" id="S47T30U786">error_set2</span> = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,134" id="srcline134">134</a></span><span class="line"><span class="mxinfo" id="T63:U435"><span class="var type1" id="S31T63U791">sp_set2</span> = <span class="mxinfo" id="T111:U437">struct(<span class="string">'val'</span>, [])</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,135" id="srcline135">135</a></span><span class="line"><span class="mxinfo" id="T30:U438"><span class="var type1" id="S32T30U799">sp_val2</span> = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,136" id="srcline136">136</a></span><span class="line"><span class="mxinfo" id="T63:U440"><span class="var type1" id="S48T63U804">ref_set2</span> = <span class="mxinfo" id="T111:U442">struct(<span class="string">'val'</span>, [])</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,137" id="srcline137">137</a></span><span class="line"><span class="mxinfo" id="T1:U443"><span class="var type1" id="S49T1U812">bspline_set2</span> = <span class="mxinfo" id="T113:U445">struct(<span class="string">'x'</span>, [], <span class="string">'y'</span>, [])</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,138" id="srcline138">138</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,139" id="srcline139">139</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S15T5U823">i</span>=<span class="mxinfo" id="T5:U447">1</span>:<span class="var type1" id="S25T5U826">surface_amount</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,140" id="srcline140">140</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T6:U449"><span class="mxinfo" id="T5:U450"><span class="var type1" id="S34T30U831">error_set</span>(<span class="var type1" id="S15T5U832">i</span>)</span> &lt; <span class="mxinfo" id="T5:U453">100</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="131,141" id="srcline141">141</a></span><span class="line">        <span class="mxinfo" id="T30:U454"><span class="var type1" id="S47T30U836">error_set2</span> = <span class="mxinfo" id="T30:U456">[<span class="var type1" id="S47T30U839">error_set2</span>; <span class="mxinfo" id="T5:U458"><span class="var type1" id="S34T30U842">error_set</span>(<span class="var type1" id="S15T5U843">i</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,142" id="srcline142">142</a></span><span class="line">        <span class="mxinfo" id="T63:U461"><span class="var type1" id="S31T63U846">sp_set2</span> = <span class="mxinfo" id="T63:U463">[<span class="var type1" id="S31T63U849">sp_set2</span>, <span class="mxinfo" id="T109:U465"><span class="var type1" id="S2T63U851">sp_set</span>(<span class="var type1" id="S15T5U852">i</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,143" id="srcline143">143</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="131,144" id="srcline144">144</a></span><span class="line">        <span class="mxinfo" id="T1:U468"><span class="var type1" id="S49T1U855">bspline_set2</span> = <span class="mxinfo" id="T1:U470">[<span class="var type1" id="S49T1U858">bspline_set2</span>, <span class="mxinfo" id="T28:U472"><span class="var type1" id="S4T1U860">bspline_set</span>(<span class="var type1" id="S15T5U861">i</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,145" id="srcline145">145</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="131,146" id="srcline146">146</a></span><span class="line">        <span class="mxinfo" id="T30:U475"><span class="var type1" id="S32T30U864">sp_val2</span> = <span class="mxinfo" id="T30:U477">[<span class="var type1" id="S32T30U867">sp_val2</span>; <span class="mxinfo" id="T5:U479"><span class="var type1" id="S3T86U870">sp_val</span>(<span class="var type1" id="S15T5U871">i</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,147" id="srcline147">147</a></span><span class="line">        <span class="mxinfo" id="T63:U482"><span class="var type1" id="S48T63U874">ref_set2</span> = <span class="mxinfo" id="T63:U484">[<span class="var type1" id="S48T63U877">ref_set2</span>, <span class="mxinfo" id="T109:U486"><span class="var type1" id="S5T63U879">ref_set</span>(<span class="var type1" id="S15T5U880">i</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,148" id="srcline148">148</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="131,149" id="srcline149">149</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,150" id="srcline150">150</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,151" id="srcline151">151</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,152" id="srcline152">152</a></span><span class="line"><span class="mxinfo" id="T63:U489"><span class="var type1" id="S31T63U884">sp_set2</span>(1) = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,153" id="srcline153">153</a></span><span class="line"><span class="mxinfo" id="T1:U491"><span class="var type1" id="S49T1U891">bspline_set2</span>(1) = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,154" id="srcline154">154</a></span><span class="line"><span class="mxinfo" id="T63:U493"><span class="var type1" id="S48T63U898">ref_set2</span>(1) = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,155" id="srcline155">155</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,156" id="srcline156">156</a></span><span class="line"><span class="mxinfo" id="T30:U495"><span class="var type1" id="S34T30U904">error_set</span> = <span class="var type1" id="S47T30U905">error_set2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,157" id="srcline157">157</a></span><span class="line"><span class="mxinfo" id="T63:U498"><span class="var type1" id="S2T63U908">sp_set</span> = <span class="var type1" id="S31T63U909">sp_set2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,158" id="srcline158">158</a></span><span class="line"><span class="mxinfo" id="T86:U501"><span class="var type1" id="S3T86U912">sp_val</span> = <span class="var type1" id="S32T30U913">sp_val2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,159" id="srcline159">159</a></span><span class="line"><span class="mxinfo" id="T1:U504"><span class="var type1" id="S4T1U916">bspline_set</span> = <span class="var type1" id="S49T1U917">bspline_set2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,160" id="srcline160">160</a></span><span class="line"><span class="mxinfo" id="T5:U507"><span class="var type1" id="S37T5U920">error</span> = <span class="mxinfo" id="T5:U509"><span class="mxinfo" id="T5:U510">sum(<span class="var type1" id="S34T30U924">error_set</span>)</span>/<span class="mxinfo" id="T5:U512">size(<span class="var type1" id="S34T30U927">error_set</span>,1)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,161" id="srcline161">161</a></span><span class="line"><span class="mxinfo" id="T63:U514"><span class="var type1" id="S5T63U931">ref_set</span> = <span class="var type1" id="S48T63U932">ref_set2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="131,162" id="srcline162">162</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,163" id="srcline163">163</a></span><span class="line">       </span></span>
<span class="srcline"><span class="lineno"><a href="131,164" id="srcline164">164</a></span><span class="line"><span class="comment"><span class="comment">%{</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="131,165" id="srcline165">165</a></span><span class="line"><span class="comment">figure; </span></span></span>
<span class="srcline"><span class="lineno"><a href="131,166" id="srcline166">166</a></span><span class="line"><span class="comment">subplot(1,2,1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,167" id="srcline167">167</a></span><span class="line"><span class="comment">imshow(result);</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,168" id="srcline168">168</a></span><span class="line"><span class="comment">subplot(1,2,2);</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,169" id="srcline169">169</a></span><span class="line"><span class="comment">imshow(result2);</span></span></span>
<span class="srcline"><span class="lineno"><a href="131,170" id="srcline170">170</a></span><span class="line"><span class="comment"><span class="comment">%}</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="131,171" id="srcline171">171</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="131,172" id="srcline172">172</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
