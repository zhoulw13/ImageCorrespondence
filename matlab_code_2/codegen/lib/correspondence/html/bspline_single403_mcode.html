<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="84,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T25U3">ref</span>] = bspline_single(<span class="var type1" id="S3T25U6">src</span>, <span class="var type1" id="S4T28U7">control_p</span>, <span class="var type1" id="S5T25U8">bound</span>, <span class="mxinfo" id="T5:U5"><span class="var type2" id="S6T5V2U9">ux</span></span>, <span class="mxinfo" id="T5:U7"><span class="var type2" id="S7T5V1U10">uy</span></span>, <span class="mxinfo" id="T5:U9"><span class="var type2" id="S8T5V2U11">vx</span></span>, <span class="mxinfo" id="T5:U11"><span class="var type2" id="S9T5V1U12">vy</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="84,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% bspline give 2d cubic uniform references of given sole point and control points</span></span></span>
<span class="srcline"><span class="lineno"><a href="84,3" id="srcline3">  3</a></span><span class="line"><span class="comment">% Detailed explanation goes here</span></span></span>
<span class="srcline"><span class="lineno"><a href="84,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="84,5" id="srcline5">  5</a></span><span class="line">coder.inline(<span class="string">'never'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="84,6" id="srcline6">  6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="84,7" id="srcline7">  7</a></span><span class="line"><span class="mxinfo" id="T29:U13"><span class="var type1" id="S11T29U21">basic_matrix</span> = <span class="mxinfo" id="T29:U15">[1,4,1,0;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="84,8" id="srcline8">  8</a></span><span class="line"><span class="mxinfo" id="T29:U13"><span class="mxinfo" id="T29:U15">                -3,0,3,0;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="84,9" id="srcline9">  9</a></span><span class="line"><span class="mxinfo" id="T29:U13"><span class="mxinfo" id="T29:U15">                3,-6,3,0;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="84,10" id="srcline10"> 10</a></span><span class="line"><span class="mxinfo" id="T29:U13"><span class="mxinfo" id="T29:U15">                -1,3,-3,1]/6</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,11" id="srcline11"> 11</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="84,12" id="srcline12"> 12</a></span><span class="line"><span class="mxinfo" id="T5:U16"><span class="var type1" id="S12T5U51">top</span> = <span class="mxinfo" id="T5:U18"><span class="var type1" id="S5T25U53">bound</span>(:, <span class="mxinfo" id="T5:U20">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,13" id="srcline13"> 13</a></span><span class="line"><span class="mxinfo" id="T5:U21"><span class="var type1" id="S13T5U58">left</span> = <span class="mxinfo" id="T5:U23"><span class="var type1" id="S5T25U60">bound</span>(:, <span class="mxinfo" id="T5:U25">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,14" id="srcline14"> 14</a></span><span class="line"><span class="mxinfo" id="T5:U26"><span class="var type1" id="S14T5U65">x</span> = <span class="mxinfo" id="T5:U28">(<span class="mxinfo" id="T5:U29"><span class="mxinfo" id="T5:U30"><span class="mxinfo" id="T5:U31"><span class="var type1" id="S3T25U71">src</span>(:,<span class="mxinfo" id="T5:U33">1</span>)</span> - <span class="var type1" id="S12T5U74">top</span></span> + <span class="mxinfo" id="T5:U35">1</span></span>)./<span class="mxinfo" id="T5:U36">30</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,15" id="srcline15"> 15</a></span><span class="line"><span class="mxinfo" id="T5:U37"><span class="var type1" id="S15T5U79">y</span> = <span class="mxinfo" id="T5:U39">(<span class="mxinfo" id="T5:U40"><span class="mxinfo" id="T5:U41"><span class="mxinfo" id="T5:U42"><span class="var type1" id="S3T25U85">src</span>(:,<span class="mxinfo" id="T5:U44">2</span>)</span> - <span class="var type1" id="S13T5U88">left</span></span> + <span class="mxinfo" id="T5:U46">1</span></span>)./<span class="mxinfo" id="T5:U47">30</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,16" id="srcline16"> 16</a></span><span class="line"><span class="mxinfo" id="T5:U48"><span class="var type1" id="S16T5U93">tx</span> = <span class="mxinfo" id="T5:U50"><span class="var type1" id="S14T5U95">x</span> - <span class="mxinfo" id="T5:U52">floor(<span class="var type1" id="S14T5U98">x</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,17" id="srcline17"> 17</a></span><span class="line"><span class="mxinfo" id="T5:U54"><span class="var type1" id="S18T5U101">ty</span> = <span class="mxinfo" id="T5:U56"><span class="var type1" id="S15T5U103">y</span> - <span class="mxinfo" id="T5:U58">floor(<span class="var type1" id="S15T5U106">y</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,18" id="srcline18"> 18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="84,19" id="srcline19"> 19</a></span><span class="line"><span class="mxinfo" id="T33:U60"><span class="var type1" id="S19T33U109">Ax</span> = <span class="mxinfo" id="T33:U62">zeros(<span class="mxinfo" id="T5:U63">size(<span class="var type1" id="S16T5U114">tx</span>,1)</span>, <span class="mxinfo" id="T5:U65">4</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,20" id="srcline20"> 20</a></span><span class="line"><span class="mxinfo" id="T5:U66"><span class="mxinfo" id="T5:U67"><span class="var type1" id="S19T33U121">Ax</span>(:, <span class="mxinfo" id="T5:U69">1</span>)</span> = <span class="mxinfo" id="T5:U70">ones(size(<span class="var type1" id="S16T5U128">tx</span>,1), 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,21" id="srcline21"> 21</a></span><span class="line"><span class="mxinfo" id="T5:U72"><span class="mxinfo" id="T5:U73"><span class="var type1" id="S19T33U134">Ax</span>(:, <span class="mxinfo" id="T5:U75">2</span>)</span> = <span class="var type1" id="S16T5U137">tx</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,22" id="srcline22"> 22</a></span><span class="line"><span class="mxinfo" id="T5:U77"><span class="mxinfo" id="T5:U78"><span class="var type1" id="S19T33U141">Ax</span>(:, <span class="mxinfo" id="T5:U80">3</span>)</span> = <span class="mxinfo" id="T5:U81"><span class="var type1" id="S16T5U145">tx</span>.^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,23" id="srcline23"> 23</a></span><span class="line"><span class="mxinfo" id="T5:U83"><span class="mxinfo" id="T5:U84"><span class="var type1" id="S19T33U150">Ax</span>(:, <span class="mxinfo" id="T5:U86">4</span>)</span> = <span class="mxinfo" id="T5:U87"><span class="var type1" id="S16T5U154">tx</span>.^3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,24" id="srcline24"> 24</a></span><span class="line"><span class="mxinfo" id="T33:U89"><span class="var type1" id="S19T33U158">Ax</span> = <span class="mxinfo" id="T33:U91"><span class="var type1" id="S19T33U160">Ax</span>*<span class="mxinfo" id="T29:U93"><span class="var type1" id="S11T29U161">basic_matrix</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,25" id="srcline25"> 25</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="84,26" id="srcline26"> 26</a></span><span class="line"><span class="mxinfo" id="T33:U95"><span class="var type1" id="S23T33U164">Ax_d</span> = <span class="mxinfo" id="T33:U97">zeros(<span class="mxinfo" id="T5:U98">size(<span class="var type1" id="S16T5U169">tx</span>,1)</span>, <span class="mxinfo" id="T5:U100">4</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,27" id="srcline27"> 27</a></span><span class="line"><span class="keyword">if</span> (<span class="var type1" id="S6T5U178">ux</span>+<span class="var type1" id="S8T5U179">vx</span>)~=0</span></span>
<span class="srcline"><span class="lineno"><a href="84,28" id="srcline28"> 28</a></span><span class="line">    <span class="var type0" id="S23T0U184">Ax_d</span>(:, 1) = zeros(size(<span class="var type0" id="S16T0U191">tx</span>,1), 1);</span></span>
<span class="srcline"><span class="lineno"><a href="84,29" id="srcline29"> 29</a></span><span class="line">    <span class="var type0" id="S23T0U197">Ax_d</span>(:, 2) = ones(size(<span class="var type0" id="S16T0U204">tx</span>,1), 1);</span></span>
<span class="srcline"><span class="lineno"><a href="84,30" id="srcline30"> 30</a></span><span class="line">    <span class="var type0" id="S23T0U210">Ax_d</span>(:, 3) = 2*<span class="var type0" id="S16T0U215">tx</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,31" id="srcline31"> 31</a></span><span class="line">    <span class="var type0" id="S23T0U219">Ax_d</span>(:, 4) = 3*<span class="var type0" id="S16T0U225">tx</span>.^2;</span></span>
<span class="srcline"><span class="lineno"><a href="84,32" id="srcline32"> 32</a></span><span class="line">    <span class="var type0" id="S23T0U229">Ax_d</span> = <span class="var type0" id="S23T0U232">Ax_d</span>*<span class="var type0" id="S11T0U233">basic_matrix</span>/30;</span></span>
<span class="srcline"><span class="lineno"><a href="84,33" id="srcline33"> 33</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="84,34" id="srcline34"> 34</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="84,35" id="srcline35"> 35</a></span><span class="line"><span class="mxinfo" id="T33:U103"><span class="var type1" id="S24T33U237">Ay</span> = <span class="mxinfo" id="T33:U105">zeros(<span class="mxinfo" id="T5:U106">size(<span class="var type1" id="S18T5U242">ty</span>,1)</span>, <span class="mxinfo" id="T5:U108">4</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,36" id="srcline36"> 36</a></span><span class="line"><span class="mxinfo" id="T5:U109"><span class="mxinfo" id="T5:U110"><span class="var type1" id="S24T33U249">Ay</span>(:, <span class="mxinfo" id="T5:U112">1</span>)</span> = <span class="mxinfo" id="T5:U113">ones(size(<span class="var type1" id="S18T5U256">ty</span>,1), 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,37" id="srcline37"> 37</a></span><span class="line"><span class="mxinfo" id="T5:U115"><span class="mxinfo" id="T5:U116"><span class="var type1" id="S24T33U262">Ay</span>(:, <span class="mxinfo" id="T5:U118">2</span>)</span> = <span class="var type1" id="S18T5U265">ty</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,38" id="srcline38"> 38</a></span><span class="line"><span class="mxinfo" id="T5:U120"><span class="mxinfo" id="T5:U121"><span class="var type1" id="S24T33U269">Ay</span>(:, <span class="mxinfo" id="T5:U123">3</span>)</span> = <span class="mxinfo" id="T5:U124"><span class="var type1" id="S18T5U273">ty</span>.^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,39" id="srcline39"> 39</a></span><span class="line"><span class="mxinfo" id="T5:U126"><span class="mxinfo" id="T5:U127"><span class="var type1" id="S24T33U278">Ay</span>(:, <span class="mxinfo" id="T5:U129">4</span>)</span> = <span class="mxinfo" id="T5:U130"><span class="var type1" id="S18T5U282">ty</span>.^3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,40" id="srcline40"> 40</a></span><span class="line"><span class="mxinfo" id="T33:U132"><span class="var type1" id="S24T33U286">Ay</span> = <span class="mxinfo" id="T33:U134"><span class="var type1" id="S24T33U288">Ay</span>*<span class="mxinfo" id="T29:U136"><span class="var type1" id="S11T29U289">basic_matrix</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,41" id="srcline41"> 41</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="84,42" id="srcline42"> 42</a></span><span class="line"><span class="mxinfo" id="T33:U138"><span class="var type1" id="S25T33U292">Ay_d</span> = <span class="mxinfo" id="T33:U140">zeros(<span class="mxinfo" id="T5:U141">size(<span class="var type1" id="S18T5U297">ty</span>,1)</span>, <span class="mxinfo" id="T5:U143">4</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,43" id="srcline43"> 43</a></span><span class="line"><span class="keyword">if</span> (<span class="var type1" id="S7T5U306">uy</span>+<span class="var type1" id="S9T5U307">vy</span>)~=0</span></span>
<span class="srcline"><span class="lineno"><a href="84,44" id="srcline44"> 44</a></span><span class="line">    <span class="mxinfo" id="T5:U146"><span class="mxinfo" id="T5:U147"><span class="var type1" id="S25T33U312">Ay_d</span>(:, <span class="mxinfo" id="T5:U149">1</span>)</span> = <span class="mxinfo" id="T5:U150">zeros(size(<span class="var type1" id="S18T5U319">ty</span>,1), 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,45" id="srcline45"> 45</a></span><span class="line">    <span class="mxinfo" id="T5:U152"><span class="mxinfo" id="T5:U153"><span class="var type1" id="S25T33U325">Ay_d</span>(:, <span class="mxinfo" id="T5:U155">2</span>)</span> = <span class="mxinfo" id="T5:U156">ones(size(<span class="var type1" id="S18T5U332">ty</span>,1), 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,46" id="srcline46"> 46</a></span><span class="line">    <span class="mxinfo" id="T5:U158"><span class="mxinfo" id="T5:U159"><span class="var type1" id="S25T33U338">Ay_d</span>(:, <span class="mxinfo" id="T5:U161">3</span>)</span> = <span class="mxinfo" id="T5:U162"><span class="mxinfo" id="T5:U163">2</span>*<span class="var type1" id="S18T5U343">ty</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,47" id="srcline47"> 47</a></span><span class="line">    <span class="mxinfo" id="T5:U165"><span class="mxinfo" id="T5:U166"><span class="var type1" id="S25T33U347">Ay_d</span>(:, <span class="mxinfo" id="T5:U168">4</span>)</span> = <span class="mxinfo" id="T5:U169"><span class="mxinfo" id="T5:U170">3</span>*<span class="mxinfo" id="T5:U171"><span class="var type1" id="S18T5U353">ty</span>.^2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,48" id="srcline48"> 48</a></span><span class="line">    <span class="mxinfo" id="T33:U173"><span class="var type1" id="S25T33U357">Ay_d</span> = <span class="mxinfo" id="T33:U175"><span class="mxinfo" id="T33:U176"><span class="var type1" id="S25T33U360">Ay_d</span>*<span class="mxinfo" id="T29:U178"><span class="var type1" id="S11T29U361">basic_matrix</span></span></span>/<span class="mxinfo" id="T5:U180">30</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,49" id="srcline49"> 49</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="84,50" id="srcline50"> 50</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="84,51" id="srcline51"> 51</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="84,52" id="srcline52"> 52</a></span><span class="line"><span class="mxinfo" id="T5:U181">[<span class="var type1" id="S26T5U366">h</span>, <span class="var type1" id="S27T5U367">w</span>] = size(<span class="mxinfo" id="T2:U184"><span class="var type1" id="S4T28U371">control_p</span>.x</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,53" id="srcline53"> 53</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="84,54" id="srcline54"> 54</a></span><span class="line"><span class="mxinfo" id="T35:U186"><span class="var type1" id="S28T35U375">A</span> = <span class="mxinfo" id="T35:U188">zeros(<span class="mxinfo" id="T5:U189">1</span>, <span class="mxinfo" id="T5:U190"><span class="var type1" id="S26T5U380">h</span>*<span class="var type1" id="S27T5U381">w</span></span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,55" id="srcline55"> 55</a></span><span class="line"><span class="mxinfo" id="T35:U193"><span class="var type1" id="S29T35U385">Au</span> = <span class="mxinfo" id="T35:U195">zeros(<span class="mxinfo" id="T5:U196">1</span>, <span class="mxinfo" id="T5:U197"><span class="var type1" id="S26T5U390">h</span>*<span class="var type1" id="S27T5U391">w</span></span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,56" id="srcline56"> 56</a></span><span class="line"><span class="mxinfo" id="T35:U200"><span class="var type1" id="S30T35U395">Av</span> = <span class="mxinfo" id="T35:U202">zeros(<span class="mxinfo" id="T5:U203">1</span>, <span class="mxinfo" id="T5:U204"><span class="var type1" id="S26T5U400">h</span>*<span class="var type1" id="S27T5U401">w</span></span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,57" id="srcline57"> 57</a></span><span class="line"><span class="keyword">if</span> sum([<span class="var type1" id="S6T5U410">ux</span>, <span class="var type1" id="S7T5U411">uy</span>, <span class="var type1" id="S8T5U412">vx</span>, <span class="var type1" id="S9T5U413">vy</span>]) == 0</span></span>
<span class="srcline"><span class="lineno"><a href="84,58" id="srcline58"> 58</a></span><span class="line">    <span class="var type0" id="S32T0U417">param_matrix</span> = zeros(<span class="var type0" id="S26T0U420">h</span>, <span class="var type0" id="S27T0U421">w</span>, 1);</span></span>
<span class="srcline"><span class="lineno"><a href="84,59" id="srcline59"> 59</a></span><span class="line">    <span class="var type0" id="S32T0U426">param_matrix</span>(1+floor(<span class="var type0" id="S14T0U432">x</span>):4+floor(<span class="var type0" id="S14T0U437">x</span>), 1+floor(<span class="var type0" id="S15T0U443">y</span>):4+floor(<span class="var type0" id="S15T0U448">y</span>)) = <span class="var type0" id="S19T0U451">Ax</span>'*<span class="var type0" id="S24T0U452">Ay</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,60" id="srcline60"> 60</a></span><span class="line">    <span class="var type0" id="S32T0U455">param_matrix</span> = <span class="var type0" id="S32T0U458">param_matrix</span>(:)';</span></span>
<span class="srcline"><span class="lineno"><a href="84,61" id="srcline61"> 61</a></span><span class="line">    <span class="var type0" id="S28T0U463">A</span>(1, :) = <span class="var type0" id="S32T0U466">param_matrix</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,62" id="srcline62"> 62</a></span><span class="line">    <span class="var type0" id="S29T0U469">Au</span> = <span class="var type0" id="S28T0U470">A</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,63" id="srcline63"> 63</a></span><span class="line">    <span class="var type0" id="S30T0U473">Av</span> = <span class="var type0" id="S28T0U474">A</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,64" id="srcline64"> 64</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="84,65" id="srcline65"> 65</a></span><span class="line">    <span class="keyword">if</span> <span class="var type1" id="S6T5U479">ux</span> == 0</span></span>
<span class="srcline"><span class="lineno"><a href="84,66" id="srcline66"> 66</a></span><span class="line">        <span class="mxinfo" id="T33:U212"><span class="var type1" id="S33T33U483">xi</span> = <span class="var type1" id="S19T33U484">Ax</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,67" id="srcline67"> 67</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="84,68" id="srcline68"> 68</a></span><span class="line">        <span class="var type0" id="S33T0U488">xi</span> = <span class="var type0" id="S23T0U489">Ax_d</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,69" id="srcline69"> 69</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="84,70" id="srcline70"> 70</a></span><span class="line">    <span class="keyword">if</span> <span class="var type1" id="S7T5U493">uy</span> == 0 </span></span>
<span class="srcline"><span class="lineno"><a href="84,71" id="srcline71"> 71</a></span><span class="line">        <span class="var type0" id="S34T0U497">yi</span> = <span class="var type0" id="S24T0U498">Ay</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,72" id="srcline72"> 72</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="84,73" id="srcline73"> 73</a></span><span class="line">        <span class="mxinfo" id="T33:U216"><span class="var type1" id="S34T33U502">yi</span> = <span class="var type1" id="S25T33U503">Ay_d</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,74" id="srcline74"> 74</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="84,75" id="srcline75"> 75</a></span><span class="line">    <span class="mxinfo" id="T2:U219"><span class="var type1" id="S32T2U506">param_matrix</span> = <span class="mxinfo" id="T2:U221">zeros(<span class="var type1" id="S26T5U509">h</span>, <span class="var type1" id="S27T5U510">w</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,76" id="srcline76"> 76</a></span><span class="line">    <span class="mxinfo" id="T29:U224"><span class="mxinfo" id="T29:U225"><span class="var type1" id="S32T2U515">param_matrix</span>(<span class="mxinfo" id="T34:U227"><span class="mxinfo" id="T5:U228">1+floor(<span class="var type1" id="S14T5U521">x</span>)</span>:<span class="mxinfo" id="T5:U230">4+floor(<span class="var type1" id="S14T5U526">x</span>)</span></span>, <span class="mxinfo" id="T34:U232"><span class="mxinfo" id="T5:U233">1+floor(<span class="var type1" id="S15T5U532">y</span>)</span>:<span class="mxinfo" id="T5:U235">4+floor(<span class="var type1" id="S15T5U537">y</span>)</span></span>)</span> = <span class="mxinfo" id="T29:U237"><span class="mxinfo" id="T34:U238"><span class="var type1" id="S33T33U540">xi</span>'</span>*<span class="var type1" id="S34T33U541">yi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,77" id="srcline77"> 77</a></span><span class="line">    <span class="mxinfo" id="T35:U241"><span class="var type1" id="S32T35U544">param_matrix</span> = <span class="mxinfo" id="T35:U243"><span class="mxinfo" id="T30:U244"><span class="var type1" id="S32T2U547">param_matrix</span>(:)</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,78" id="srcline78"> 78</a></span><span class="line">    <span class="mxinfo" id="T35:U246"><span class="mxinfo" id="T35:U247"><span class="var type1" id="S29T35U552">Au</span>(1, :)</span> = <span class="var type1" id="S32T35U555">param_matrix</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,79" id="srcline79"> 79</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="84,80" id="srcline80"> 80</a></span><span class="line">    <span class="keyword">if</span> <span class="var type1" id="S8T5U559">vx</span> == 0</span></span>
<span class="srcline"><span class="lineno"><a href="84,81" id="srcline81"> 81</a></span><span class="line">        <span class="mxinfo" id="T33:U251"><span class="var type1" id="S33T33U563">xi</span> = <span class="var type1" id="S19T33U564">Ax</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,82" id="srcline82"> 82</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="84,83" id="srcline83"> 83</a></span><span class="line">        <span class="var type0" id="S33T0U568">xi</span> = <span class="var type0" id="S23T0U569">Ax_d</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,84" id="srcline84"> 84</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="84,85" id="srcline85"> 85</a></span><span class="line">    <span class="keyword">if</span> <span class="var type1" id="S9T5U573">vy</span> == 0 </span></span>
<span class="srcline"><span class="lineno"><a href="84,86" id="srcline86"> 86</a></span><span class="line">        <span class="var type0" id="S34T0U577">yi</span> = <span class="var type0" id="S24T0U578">Ay</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,87" id="srcline87"> 87</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="84,88" id="srcline88"> 88</a></span><span class="line">        <span class="mxinfo" id="T33:U255"><span class="var type1" id="S34T33U582">yi</span> = <span class="var type1" id="S25T33U583">Ay_d</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,89" id="srcline89"> 89</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="84,90" id="srcline90"> 90</a></span><span class="line">    <span class="mxinfo" id="T2:U258"><span class="var type1" id="S32T2U586">param_matrix</span> = <span class="mxinfo" id="T2:U260">zeros(<span class="var type1" id="S26T5U589">h</span>, <span class="var type1" id="S27T5U590">w</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,91" id="srcline91"> 91</a></span><span class="line">    <span class="mxinfo" id="T29:U263"><span class="mxinfo" id="T29:U264"><span class="var type1" id="S32T2U595">param_matrix</span>(<span class="mxinfo" id="T34:U266"><span class="mxinfo" id="T5:U267">1+floor(<span class="var type1" id="S14T5U601">x</span>)</span>:<span class="mxinfo" id="T5:U269">4+floor(<span class="var type1" id="S14T5U606">x</span>)</span></span>, <span class="mxinfo" id="T34:U271"><span class="mxinfo" id="T5:U272">1+floor(<span class="var type1" id="S15T5U612">y</span>)</span>:<span class="mxinfo" id="T5:U274">4+floor(<span class="var type1" id="S15T5U617">y</span>)</span></span>)</span> = <span class="mxinfo" id="T29:U276"><span class="mxinfo" id="T34:U277"><span class="var type1" id="S33T33U620">xi</span>'</span>*<span class="var type1" id="S34T33U621">yi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,92" id="srcline92"> 92</a></span><span class="line">    <span class="mxinfo" id="T35:U280"><span class="var type1" id="S32T35U624">param_matrix</span> = <span class="mxinfo" id="T35:U282"><span class="mxinfo" id="T30:U283"><span class="var type1" id="S32T2U627">param_matrix</span>(:)</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,93" id="srcline93"> 93</a></span><span class="line">    <span class="mxinfo" id="T35:U285"><span class="mxinfo" id="T35:U286"><span class="var type1" id="S30T35U632">Av</span>(1, :)</span> = <span class="var type1" id="S32T35U635">param_matrix</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,94" id="srcline94"> 94</a></span><span class="line"><span class="keyword">end</span>    </span></span>
<span class="srcline"><span class="lineno"><a href="84,95" id="srcline95"> 95</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="84,96" id="srcline96"> 96</a></span><span class="line"><span class="mxinfo" id="T25:U289"><span class="var type1" id="S2T25U638">ref</span> = <span class="mxinfo" id="T25:U291">zeros(<span class="mxinfo" id="T5:U292">size(<span class="var type1" id="S3T25U643">src</span>, 1)</span>, <span class="mxinfo" id="T5:U294">2</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,97" id="srcline97"> 97</a></span><span class="line"><span class="mxinfo" id="T2:U295"><span class="var type1" id="S35T2U649">temp1</span> = <span class="mxinfo" id="T2:U297"><span class="var type1" id="S4T28U651">control_p</span>.x</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,98" id="srcline98"> 98</a></span><span class="line"><span class="mxinfo" id="T2:U299"><span class="var type1" id="S36T2U655">temp2</span> = <span class="mxinfo" id="T2:U301"><span class="var type1" id="S4T28U657">control_p</span>.y</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,99" id="srcline99"> 99</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="84,100" id="srcline100">100</a></span><span class="line"><span class="mxinfo" id="T5:U303"><span class="mxinfo" id="T5:U304"><span class="var type1" id="S2T25U662">ref</span>(:, <span class="mxinfo" id="T5:U306">1</span>)</span> = <span class="mxinfo" id="T5:U307"><span class="var type1" id="S29T35U666">Au</span>*<span class="mxinfo" id="T30:U309"><span class="var type1" id="S35T2U668">temp1</span>(:)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,101" id="srcline101">101</a></span><span class="line"><span class="mxinfo" id="T5:U311"><span class="mxinfo" id="T5:U312"><span class="var type1" id="S2T25U673">ref</span>(:, <span class="mxinfo" id="T5:U314">2</span>)</span> = <span class="mxinfo" id="T5:U315"><span class="var type1" id="S30T35U677">Av</span>*<span class="mxinfo" id="T30:U317"><span class="var type1" id="S36T2U679">temp2</span>(:)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="84,102" id="srcline102">102</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="84,103" id="srcline103">103</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
